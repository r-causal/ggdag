<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ggdag">
<title>Common Structures of Bias • ggdag</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Common Structures of Bias">
<meta property="og:description" content="ggdag">
<meta property="og:image" content="https://r-causal.github.io/ggdag/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ggdag</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.11.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/intro-to-ggdag.html">An Introduction to ggdag</a>
    <a class="dropdown-item" href="../articles/intro-to-dags.html">An Introduction to DAGs</a>
    <a class="dropdown-item" href="../articles/bias-structures.html">Common Structures of Bias</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/r-causal/ggdag/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Common Structures of Bias</h1>
                        <h4 data-toc-skip class="author">Malcolm
Barrett</h4>
            
            <h4 data-toc-skip class="date">2024-02-04</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/r-causal/ggdag/blob/HEAD/vignettes/bias-structures.Rmd" class="external-link"><code>vignettes/bias-structures.Rmd</code></a></small>
      <div class="d-none name"><code>bias-structures.Rmd</code></div>
    </div>

    
    
<p><em>A quick note on terminology: I use the terms confounding and
selection bias below, the terms of choice in epidemiology. The terms,
however, depend on the field. In some fields, confounding is referred to
as omitted variable bias or selection bias. Selection bias also
sometimes refers to</em> variable <em>selection bias, a related issue
that refers to misspecified models.</em></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#  set theme of all DAGs to `theme_dag()`</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-causal/ggdag" class="external-link">ggdag</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="../reference/theme_dag_blank.html">theme_dag</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In addition to helping identify causal effects, the consistency of
directed acyclic graphs (DAGs) is very useful in thinking about
different forms of bias. Often, many seemingly unrelated types of bias
take the same form in a DAG. Methodological issues in a study often
reduce to a problem of 1) not adequately blocking a back-door path or 2)
selecting on some variable that turns out to be a collider.</p>
</div>
<div class="section level2">
<h2 id="confounders-and-confounding">Confounders and confounding<a class="anchor" aria-label="anchor" href="#confounders-and-confounding"></a>
</h2>
<p>Classical confounding is simple. A confounder is associated with both
the exposure and the outcome. Let’s consider a classic example: coffee,
smoking, and cancer. Smoking is a risk factor for a number of cancers,
and people who drink coffee are more likely to smoke. Coffee doesn’t
actually cause lung cancer, but they are d-connected through smoking, so
they will appear to be associated:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/quick_plot.html">confounder_triangle</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Coffee"</span>, y <span class="op">=</span> <span class="st">"Lung Cancer"</span>, z <span class="op">=</span> <span class="st">"Smoking"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/d_relationship.html">ggdag_dconnected</a></span><span class="op">(</span>text <span class="op">=</span> <span class="cn">FALSE</span>, use_labels <span class="op">=</span> <span class="st">"label"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bias-structures_files/figure-html/unnamed-chunk-1-1.png" width="2240" style="display: block; margin: auto;"></p>
<p>But if you think about it, this DAG is incorrect. Smoking doesn’t
cause coffee drinking; something else, say a predilection towards
addictive substances, causes a person to both smoke and drink coffee.
Let’s say that we had a psychometric tool that accurately measures
addictive behavior, so we can control for it. Now our DAG looks like
this:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coffee_dag</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dagify.html">dagify</a></span><span class="op">(</span></span>
<span>  <span class="va">cancer</span> <span class="op">~</span> <span class="va">smoking</span>,</span>
<span>  <span class="va">smoking</span> <span class="op">~</span> <span class="va">addictive</span>,</span>
<span>  <span class="va">coffee</span> <span class="op">~</span> <span class="va">addictive</span>,</span>
<span>  exposure <span class="op">=</span> <span class="st">"coffee"</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"cancer"</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"coffee"</span> <span class="op">=</span> <span class="st">"Coffee"</span>,</span>
<span>    <span class="st">"cancer"</span> <span class="op">=</span> <span class="st">"Lung Cancer"</span>,</span>
<span>    <span class="st">"smoking"</span> <span class="op">=</span> <span class="st">"Smoking"</span>,</span>
<span>    <span class="st">"addictive"</span> <span class="op">=</span> <span class="st">"Addictive \nBehavior"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/tidy_dagitty.html">tidy_dagitty</a></span><span class="op">(</span>layout <span class="op">=</span> <span class="st">"tree"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ggdag.html">ggdag</a></span><span class="op">(</span><span class="va">coffee_dag</span>, text <span class="op">=</span> <span class="cn">FALSE</span>, use_labels <span class="op">=</span> <span class="st">"label"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bias-structures_files/figure-html/unnamed-chunk-2-1.png" width="2240" style="display: block; margin: auto;"></p>
<p>Which one is the confounder, addictive behavior or smoking? Only one
or the other needs to be controlled for to block the path:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/adjustment_sets.html">ggdag_adjustment_set</a></span><span class="op">(</span><span class="va">coffee_dag</span>, text <span class="op">=</span> <span class="cn">FALSE</span>, use_labels <span class="op">=</span> <span class="st">"label"</span>, shadow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="bias-structures_files/figure-html/unnamed-chunk-3-1.png" width="2400" style="display: block; margin: auto;"></p>
<p>Focusing on individual confounders, rather than confounding pathways,
is a common error in thinking about adjusting our estimates. We should
be more concerned blocking all confounding pathways than with including
any particular variable <em>along</em> those pathways. (It’s worth
noting, though, that when I say you only need one variable to block a
path, that assumes you are measuring and modeling the variable
correctly. If, for example, there is measurement error, controlling for
that variable may still leave residual confounding, necessitating a more
subtle level of control with other variables on the pathway; see the
section on measurement error below. Moreover, it’s important to know
that you expect to block the path <em>on average</em>; normal sampling
issues, e.g. sample size, still come into play.)</p>
</div>
<div class="section level2">
<h2 id="colliders-m-bias-and-butterfly-bias">Colliders, M-bias, and butterfly bias<a class="anchor" aria-label="anchor" href="#colliders-m-bias-and-butterfly-bias"></a>
</h2>
<p>Stratifying on a collider is a major culprit in systematic bias.
Controlling for a collider–a node where two or more arrow heads
meet–induces an association between its parents, through which
confounding can flow:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/quick_plot.html">collider_triangle</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/d_relationship.html">ggdag_dseparated</a></span><span class="op">(</span>controlling_for <span class="op">=</span> <span class="st">"m"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bias-structures_files/figure-html/unnamed-chunk-4-1.png" width="2240" style="display: block; margin: auto;"></p>
<p>Here, the example is fairly simple and easy to deal with: <em>m</em>
is a child of <em>x</em> and <em>y</em> and just shouldn’t be adjusted
for. It can get more complicated, though, when <em>m</em> is something
that seems like it is a confounder or when it represents a variable that
contributes to whether or not a person enters the study. Often this
takes the form of M-shaped bias, or M-bias. Let’s consider an example
from <a href="https://books.google.com/books/about/Modern_Epidemiology.html?id=Z3vjT9ALxHUC" class="external-link">Modern
Epidemiology</a>: the association between education and diabetes. Let’s
assume that lack of education isn’t a direct cause of diabetes. When we
are putting together our analysis, we ask: should we adjust for the
participant’s mother’s history of diabetes? It’s linked to education via
income and to participant’s diabetes status via genetic risk, so it
looks like this:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/quick_plot.html">m_bias</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="st">"Education"</span>,</span>
<span>  y <span class="op">=</span> <span class="st">"Diabetes"</span>,</span>
<span>  a <span class="op">=</span> <span class="st">"Income during Childhood"</span>,</span>
<span>  b <span class="op">=</span> <span class="st">"Genetic Risk \nfor Diabetes"</span>,</span>
<span>  m <span class="op">=</span> <span class="st">"Mother's Diabetes"</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/ggdag.html">ggdag</a></span><span class="op">(</span>use_labels <span class="op">=</span> <span class="st">"label"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bias-structures_files/figure-html/unnamed-chunk-5-1.png" width="2240" style="display: block; margin: auto;"></p>
<p>From a classical confounding perspective, it seems like the mother’s
diabetes status might be a confounder: it’s associated with both the
exposure and outcome, and it’s not a descendant of either. However, the
association with the outcome and exposure is not direct for either; it’s
due to confounding by genetic risk and childhood income, respectively.
Drawing it as a DAG makes it clear that the mother’s diabetes status is
a collider, and adjusting for it will induce an association between
genetic risk and childhood income, thus opening a back-door path from
education to diabetes status:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/quick_plot.html">m_bias</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="st">"Education"</span>,</span>
<span>  y <span class="op">=</span> <span class="st">"Diabetes"</span>,</span>
<span>  a <span class="op">=</span> <span class="st">"Income during \nChildhood"</span>,</span>
<span>  b <span class="op">=</span> <span class="st">"Genetic Risk \nfor Diabetes"</span>,</span>
<span>  m <span class="op">=</span> <span class="st">"Mother's Diabetes"</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/d_relationship.html">ggdag_dseparated</a></span><span class="op">(</span>controlling_for <span class="op">=</span> <span class="st">"m"</span>, use_labels <span class="op">=</span> <span class="st">"label"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bias-structures_files/figure-html/unnamed-chunk-6-1.png" width="2400" style="display: block; margin: auto;"></p>
<p>Again, this is relatively easy–just don’t control for the collider.
But what about when your study design already stratifies on <em>m</em>?
Let’s consider an example where <em>m</em> represents having surgery.
Let’s say we are conducting a study involving participants who had
surgery due to back pain. We suspect that people who are ready to commit
to physical therapy and changes in their daily life will have a greater
decrease in pain after a year than those who aren’t. We’ve developed a
psychometric tool that measures readiness for surgery, and we are going
to look at the association between readiness and change in pain. The
readiness scale depends on an underlying latent variable that is true
readiness, which we are measuring with some error. Change in pain
depends on baseline pain. Both underlying readiness and baseline pain
are also predictive of whether or not someone has surgery. By
definition, we are selecting on surgical status: we feel it’s unethical
to withhold it and irresponsible to force all participants to have
surgery. So, we can’t know how people who didn’t have surgery would
react. Surgical status is inherently stratified for, because we’re only
looking at people who have had it (note that from here on out, I’m not
going to show the paths opened by adjusting for a collider, the default
in <code>ggdag</code>, for clarity):</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu">dagitty</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dagitty/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="fu"><a href="../reference/quick_plot.html">m_bias</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/coordinates.html">coords2df</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">coords</span><span class="op">$</span><span class="va">name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"readiness"</span>, <span class="st">"pain"</span>, <span class="st">"surgery"</span>, <span class="st">"ready_tool"</span>, <span class="st">"pain_change"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">surgical_dag</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dagify.html">dagify</a></span><span class="op">(</span></span>
<span>  <span class="va">ready_tool</span> <span class="op">~</span> <span class="va">readiness</span>,</span>
<span>  <span class="va">surgery</span> <span class="op">~</span> <span class="va">readiness</span> <span class="op">+</span> <span class="va">pain</span>,</span>
<span>  <span class="va">pain_change</span> <span class="op">~</span> <span class="va">ready_tool</span> <span class="op">+</span> <span class="va">pain</span>,</span>
<span>  exposure <span class="op">=</span> <span class="st">"ready_tool"</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"pain_change"</span>,</span>
<span>  latent <span class="op">=</span> <span class="st">"readiness"</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    ready_tool <span class="op">=</span> <span class="st">"Measured \nReadiness"</span>,</span>
<span>    pain_change <span class="op">=</span> <span class="st">"Change \nin Pain"</span>,</span>
<span>    readiness <span class="op">=</span> <span class="st">"Underlying \nReadiness"</span>,</span>
<span>    pain <span class="op">=</span> <span class="st">"Baseline \nPain"</span>,</span>
<span>    surgery <span class="op">=</span> <span class="st">"Surgical \nStatus"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  coords <span class="op">=</span> <span class="fu"><a href="../reference/coordinates.html">coords2list</a></span><span class="op">(</span><span class="va">coords</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/control_for.html">control_for</a></span><span class="op">(</span><span class="st">"surgery"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/control_for.html">ggdag_adjust</a></span><span class="op">(</span><span class="va">surgical_dag</span>, text <span class="op">=</span> <span class="cn">FALSE</span>, use_labels <span class="op">=</span> <span class="st">"label"</span>, collider_lines <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="bias-structures_files/figure-html/unnamed-chunk-7-1.png" width="2240" style="display: block; margin: auto;"></p>
<p>We can’t unstratify by surgical status, so our best bet is to block
the back-door path opened by stratifying on it. We can’t adjust for the
latent variable (and, if we’re measuring it really well, the latent
variable and the tool are one in the same), so all we can do is control
for baseline pain. Note that, technically, surgical status is part of
the adjustment set:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/adjustment_sets.html">ggdag_adjustment_set</a></span><span class="op">(</span><span class="va">surgical_dag</span>, text <span class="op">=</span> <span class="cn">FALSE</span>, use_labels <span class="op">=</span> <span class="st">"label"</span>, shadow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="bias-structures_files/figure-html/unnamed-chunk-8-1.png" width="2240" style="display: block; margin: auto;"></p>
<p>What about if a variable is both a collider and a cause of the
exposure and outcome (a classical confounder)? This is an extension of
M-bias sometimes called butterfly bias or bow-tie bias. The variable is
a part of two paths: one that it’s blocking as a collider <em>and</em> a
back-door path that is confounding the relationship between <em>x</em>
and <em>y</em>. What to do?</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/quick_plot.html">ggdag_butterfly_bias</a></span><span class="op">(</span>edge_type <span class="op">=</span> <span class="st">"diagonal"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bias-structures_files/figure-html/unnamed-chunk-9-1.png" width="2240" style="display: block; margin: auto;"></p>
<p>The strategy is basically the same as above; we need to control for
<em>m</em> to block the back-door path, but that opens up a relationship
between <em>a</em> and <em>b</em>, so we need to block that path,
too.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/adjustment_sets.html">ggdag_adjustment_set</a></span><span class="op">(</span><span class="fu"><a href="../reference/quick_plot.html">butterfly_bias</a></span><span class="op">(</span><span class="op">)</span>, shadow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="bias-structures_files/figure-html/unnamed-chunk-10-1.png" width="2240" style="display: block; margin: auto;"></p>
<p>Adjusting for either set, {<em>a</em>, <em>m</em>} or {<em>b</em>,
<em>m</em>}, will give allow us to estimate the causal effect of
<em>x</em> on <em>y</em>.</p>
</div>
<div class="section level2">
<h2 id="measurement-error">Measurement error<a class="anchor" aria-label="anchor" href="#measurement-error"></a>
</h2>
<p>Measurement error is the degree to which we mismeasure a variable,
which can lead to bias in a number of ways. If the error is dependent on
the exposure or the outcome, (e.g. we measure the exposure with less
accuracy for a group without a disease than with it), it is called
differential measurement error. If the error has nothing to do with the
exposure or outcome, it’s called non-differential measurement error.
Under most conditions, non-differential error will bias the estimate of
effect towards the null. In this way, it’s at least predictable, but for
small effects or inadequately powered studies, it can make a true effect
disappear. If there is error in both the exposure and outcome, the
errors themselves can also be associated, opening a back-door path
between the exposure and outcome.</p>
<p>Let’s consider an example with non-differential error for the outcome
and differential error for the exposure. One common situation where this
can occur is recall bias. Let’s say we want to know if taking
multivitamins in childhood helps protect against bladder cancer later in
life.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set coordinates</span></span>
<span><span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">name</span>,</span>
<span>  <span class="op">~</span><span class="va">x</span>,</span>
<span>  <span class="op">~</span><span class="va">y</span>,</span>
<span>  <span class="st">"bladder_cancer"</span>,</span>
<span>  <span class="fl">1</span>,</span>
<span>  <span class="fl">0</span>,</span>
<span>  <span class="st">"vitamins"</span>,</span>
<span>  <span class="fl">0</span>,</span>
<span>  <span class="fl">0</span>,</span>
<span>  <span class="st">"diagnosed_bc"</span>,</span>
<span>  <span class="fl">1</span>,</span>
<span>  <span class="fl">1</span>,</span>
<span>  <span class="st">"recalled_vits"</span>,</span>
<span>  <span class="fl">0</span>,</span>
<span>  <span class="fl">1</span>,</span>
<span>  <span class="st">"bc_error"</span>,</span>
<span>  <span class="fl">1</span>,</span>
<span>  <span class="fl">2</span>,</span>
<span>  <span class="st">"vits_error"</span>,</span>
<span>  <span class="fl">0</span>,</span>
<span>  <span class="fl">2</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">bladder_dag</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dagify.html">dagify</a></span><span class="op">(</span></span>
<span>  <span class="va">diagnosed_bc</span> <span class="op">~</span> <span class="va">bc_error</span> <span class="op">+</span> <span class="va">bladder_cancer</span>,</span>
<span>  <span class="va">recalled_vits</span> <span class="op">~</span> <span class="va">vitamins</span> <span class="op">+</span> <span class="va">vits_error</span>,</span>
<span>  <span class="va">vits_error</span> <span class="op">~</span> <span class="va">bladder_cancer</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    bladder_cancer <span class="op">=</span> <span class="st">"Bladder Cancer"</span>,</span>
<span>    vitamins <span class="op">=</span> <span class="st">"Childhood Vitamin \nIntake"</span>,</span>
<span>    diagnosed_bc <span class="op">=</span> <span class="st">"Diagnosed \nBladder Cancer"</span>,</span>
<span>    recalled_vits <span class="op">=</span> <span class="st">"Memory of \nTaking Vitamins"</span>,</span>
<span>    bc_error <span class="op">=</span> <span class="st">"Measurement Error, \nDiagnosis"</span>,</span>
<span>    vits_error <span class="op">=</span> <span class="st">"Measurement Error, \nVitamins"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  coords <span class="op">=</span> <span class="va">coords</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ggdag.html">ggdag</a></span><span class="op">(</span><span class="va">bladder_dag</span>, text <span class="op">=</span> <span class="cn">FALSE</span>, use_labels <span class="op">=</span> <span class="st">"label"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bias-structures_files/figure-html/unnamed-chunk-11-1.png" width="2240" style="display: block; margin: auto;"></p>
<p>For the outcome, the bias only depends on how well diagnosis of
bladder cancer represents actually having bladder cancer. For the
exposure, however, it also depends on if you have cancer or not: people
who are sick tend to spend more time reflecting on what could have
caused the illness. Thus, they will remember the vitamins they took as
children, on average, a little better than controls. If there is no
effect of vitamins on bladder cancer, this dependency will make it seem
as if vitamins are a <em>risk</em> for bladder cancer. If it is, in
fact, protective, recall bias can reduce or even reverse the
association.</p>
<p>Measurement error can also cause bias in longitudinal settings. Let’s
consider another example from Modern Epidemiology, which uses the
Centers for Epidemiologic Studies–Depression (CES-D) scale, a common
tool to assess depression that is known to have measurement error. In
this example, the question is if graduating from college with an honors
degree affects how depression changes after graduation. Assuming it
doesn’t, adjusting for baseline CES-D score–a common practice–can induce
bias via measurement error:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set coordinates</span></span>
<span><span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">name</span>,</span>
<span>  <span class="op">~</span><span class="va">x</span>,</span>
<span>  <span class="op">~</span><span class="va">y</span>,</span>
<span>  <span class="st">"honors"</span>,</span>
<span>  <span class="fl">1</span>,</span>
<span>  <span class="fl">3</span>,</span>
<span>  <span class="st">"depression"</span>,</span>
<span>  <span class="fl">2</span>,</span>
<span>  <span class="fl">3</span>,</span>
<span>  <span class="st">"cesd"</span>,</span>
<span>  <span class="fl">2</span>,</span>
<span>  <span class="fl">2</span>,</span>
<span>  <span class="st">"baseline_error"</span>,</span>
<span>  <span class="fl">2</span>,</span>
<span>  <span class="fl">1</span>,</span>
<span>  <span class="st">"depression_change"</span>,</span>
<span>  <span class="fl">3</span>,</span>
<span>  <span class="fl">3</span>,</span>
<span>  <span class="st">"cesd_change"</span>,</span>
<span>  <span class="fl">3</span>,</span>
<span>  <span class="fl">2</span>,</span>
<span>  <span class="st">"followup_error"</span>,</span>
<span>  <span class="fl">3</span>,</span>
<span>  <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cesd_dag</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dagify.html">dagify</a></span><span class="op">(</span></span>
<span>  <span class="va">depression</span> <span class="op">~</span> <span class="va">honors</span>,</span>
<span>  <span class="va">cesd</span> <span class="op">~</span> <span class="va">depression</span> <span class="op">+</span> <span class="va">baseline_error</span>,</span>
<span>  <span class="va">cesd_change</span> <span class="op">~</span> <span class="va">depression_change</span> <span class="op">+</span> <span class="va">followup_error</span> <span class="op">+</span> <span class="va">baseline_error</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    honors <span class="op">=</span> <span class="st">"Honors Degree"</span>,</span>
<span>    depression <span class="op">=</span> <span class="st">"Depression"</span>,</span>
<span>    cesd <span class="op">=</span> <span class="st">"CES-D"</span>,</span>
<span>    cesd_change <span class="op">=</span> <span class="st">"Change \nin CES-D"</span>,</span>
<span>    depression_change <span class="op">=</span> <span class="st">"Change in \nDepression"</span>,</span>
<span>    baseline_error <span class="op">=</span> <span class="st">"Measurement Error, \nBaseline"</span>,</span>
<span>    followup_error <span class="op">=</span> <span class="st">"Measurement Error, \nFollow-up"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  coords <span class="op">=</span> <span class="va">coords</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cesd_dag</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/d_relationship.html">ggdag_dconnected</a></span><span class="op">(</span></span>
<span>    from <span class="op">=</span> <span class="st">"honors"</span>,</span>
<span>    to <span class="op">=</span> <span class="st">"cesd_change"</span>,</span>
<span>    controlling_for <span class="op">=</span> <span class="st">"cesd"</span>,</span>
<span>    text <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    use_labels <span class="op">=</span> <span class="st">"label"</span>,</span>
<span>    collider_lines <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="bias-structures_files/figure-html/unnamed-chunk-12-1.png" width="2240" style="display: block; margin: auto;"></p>
<p>Because both the baseline score and the change are due, in part, to
measurement error at baseline, controlling for baseline CES-D score (a
collider) causes change in CES-D and receiving an honors degree to be
d-connected.</p>
</div>
<div class="section level2">
<h2 id="selection-bias">Selection bias<a class="anchor" aria-label="anchor" href="#selection-bias"></a>
</h2>
<p>We have already seen a few examples of selection bias, but let’s
consider a couple more that are potential pitfalls in common design
types. Let’s say we’re doing a case-control study and want to assess the
effect of smoking on glioma, a type of brain cancer. We have a group of
glioma patients at a hospital and want to compare them to a group of
controls, so we pick people in the hospital with a broken bone, since
that seems to have nothing to do with brain cancer. However, perhaps
there is some unknown confounding between smoking and being in the
hospital with a broken bone, like being prone to reckless behavior. In
the normal population, there is no causal effect of smoking on glioma,
but in our case, we’re selecting on people who have been hospitalized,
which opens up a back-door path:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">name</span>,</span>
<span>  <span class="op">~</span><span class="va">x</span>,</span>
<span>  <span class="op">~</span><span class="va">y</span>,</span>
<span>  <span class="st">"glioma"</span>,</span>
<span>  <span class="fl">1</span>,</span>
<span>  <span class="fl">2</span>,</span>
<span>  <span class="st">"hospitalized"</span>,</span>
<span>  <span class="fl">2</span>,</span>
<span>  <span class="fl">3</span>,</span>
<span>  <span class="st">"broken_bone"</span>,</span>
<span>  <span class="fl">3</span>,</span>
<span>  <span class="fl">2</span>,</span>
<span>  <span class="st">"reckless"</span>,</span>
<span>  <span class="fl">4</span>,</span>
<span>  <span class="fl">1</span>,</span>
<span>  <span class="st">"smoking"</span>,</span>
<span>  <span class="fl">5</span>,</span>
<span>  <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/dagify.html">dagify</a></span><span class="op">(</span></span>
<span>  <span class="va">hospitalized</span> <span class="op">~</span> <span class="va">broken_bone</span> <span class="op">+</span> <span class="va">glioma</span>,</span>
<span>  <span class="va">broken_bone</span> <span class="op">~</span> <span class="va">reckless</span>,</span>
<span>  <span class="va">smoking</span> <span class="op">~</span> <span class="va">reckless</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    hospitalized <span class="op">=</span> <span class="st">"Hospitalization"</span>,</span>
<span>    broken_bone <span class="op">=</span> <span class="st">"Broken Bone"</span>,</span>
<span>    glioma <span class="op">=</span> <span class="st">"Glioma"</span>,</span>
<span>    reckless <span class="op">=</span> <span class="st">"Reckless \nBehavior"</span>,</span>
<span>    smoking <span class="op">=</span> <span class="st">"Smoking"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  coords <span class="op">=</span> <span class="va">coords</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/d_relationship.html">ggdag_dconnected</a></span><span class="op">(</span></span>
<span>    <span class="st">"glioma"</span>,</span>
<span>    <span class="st">"smoking"</span>,</span>
<span>    controlling_for <span class="op">=</span> <span class="st">"hospitalized"</span>,</span>
<span>    text <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    use_labels <span class="op">=</span> <span class="st">"label"</span>,</span>
<span>    collider_lines <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="bias-structures_files/figure-html/unnamed-chunk-13-1.png" width="2240" style="display: block; margin: auto;"></p>
<p>Even though smoking doesn’t actually cause glioma, it will appear as
if there is an association. Actually, in this case, it may make smoking
appear to be <em>protective</em> against glioma, since controls are more
likely to be smokers.</p>
<p>Let’s also consider how bias arises in loss-to-follow-up. In a
randomized clinical trial or cohort study, the main threat of selection
bias is not through who enters the study (although that may affect
generalizability) but who leaves it. If loss-to-follow-up is associated
with the exposure or outcome, the relationship between the two may be
biased. Let’s consider a trial where we are testing a new HIV drug and
its effect on CD4 white blood cell count. If the treatment causes
symptoms, participants may leave the trial. Similarly, there may be
those whose HIV is getting worse and thus more symptomatic, which also
may cause people to leave the trial. If we only have information on
people who stay in the study, we are stratifying by follow-up
status:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dagify.html">dagify</a></span><span class="op">(</span></span>
<span>  <span class="va">follow_up</span> <span class="op">~</span> <span class="va">symptoms</span>,</span>
<span>  <span class="va">symptoms</span> <span class="op">~</span> <span class="va">new_rx</span> <span class="op">+</span> <span class="va">dx_severity</span>,</span>
<span>  <span class="va">cd4</span> <span class="op">~</span> <span class="va">dx_severity</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    follow_up <span class="op">=</span> <span class="st">"Follow-Up"</span>,</span>
<span>    symptoms <span class="op">=</span> <span class="st">"Symptoms"</span>,</span>
<span>    new_rx <span class="op">=</span> <span class="st">"New HIV Drug"</span>,</span>
<span>    dx_severity <span class="op">=</span> <span class="st">"Underyling \nHIV Severity"</span>,</span>
<span>    cd4 <span class="op">=</span> <span class="st">"CD4 Count"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/control_for.html">ggdag_adjust</a></span><span class="op">(</span></span>
<span>    <span class="st">"follow_up"</span>,</span>
<span>    layout <span class="op">=</span> <span class="st">"mds"</span>,</span>
<span>    text <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    use_labels <span class="op">=</span> <span class="st">"label"</span>,</span>
<span>    collider_lines <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="bias-structures_files/figure-html/unnamed-chunk-14-1.png" width="2240" style="display: block; margin: auto;"></p>
<p>But follow-up is downstream from a collider, symptoms. Controlling
for a downstream collider induces bias and, because we only have
information on people who remain in the study, we are inadvertently
stratifying on follow-up status (see the <a href="intro-to-dags.html">vignette introducing DAGs</a> for more on
downstream colliders). Thus, the effect estimate between the HIV drug
and CD4 count will be biased.</p>
</div>
<div class="section level2">
<h2 id="resources">Resources<a class="anchor" aria-label="anchor" href="#resources"></a>
</h2>
<p>Many, if not all, forms of systematic bias can be drawn as DAGs. Here
are a few sources with interesting examples:</p>
<ul>
<li>Miguel Hernán’s course on DAGs includes a number of examples on
common structures of bias: <a href="https://www.edx.org/learn/data-analysis/harvard-university-causal-diagrams-draw-your-assumptions-before-your-conclusions" class="external-link">Causal
Diagrams: Draw Your Assumptions Before Your Conclusions</a>. Also see
his article <a href="https://pubmed.ncbi.nlm.nih.gov/15308962/" class="external-link">A
structural approach to selection bias</a>.</li>
<li>The chapter on DAGs in <a href="https://books.google.com/books/about/Modern_Epidemiology.html?id=Z3vjT9ALxHUC" class="external-link">Modern
Epidemiology</a> includes a couple of the examples here and many more
directly related to conducting observational research, including
measurement error, selection bias, residual confounding, and missing
data.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://malco.io" class="external-link">Malcolm Barrett</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>

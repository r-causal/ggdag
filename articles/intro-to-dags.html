<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ggdag">
<title>An Introduction to Directed Acyclic Graphs • ggdag</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="An Introduction to Directed Acyclic Graphs">
<meta property="og:description" content="ggdag">
<meta property="og:image" content="https://r-causal.github.io/ggdag/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ggdag</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.10.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/intro-to-ggdag.html">An Introduction to ggdag</a>
    <a class="dropdown-item" href="../articles/intro-to-dags.html">An Introduction to DAGs</a>
    <a class="dropdown-item" href="../articles/bias-structures.html">Common Structures of Bias</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/r-causal/ggdag/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>An Introduction to Directed Acyclic Graphs</h1>
                        <h4 data-toc-skip class="author">Malcolm
Barrett</h4>
            
            <h4 data-toc-skip class="date">2024-01-21</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/r-causal/ggdag/blob/HEAD/vignettes/intro-to-dags.Rmd" class="external-link"><code>vignettes/intro-to-dags.Rmd</code></a></small>
      <div class="d-none name"><code>intro-to-dags.Rmd</code></div>
    </div>

    
    
<p><em>A quick note on terminology: I use the terms confounding and
selection bias below, the terms of choice in epidemiology. The terms,
however, depend on the field. In some fields, confounding is referred to
as omitted variable bias or selection bias. Selection bias also
sometimes refers to</em> variable <em>selection bias, a related issue
that refers to misspecified models.</em></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#  set theme of all DAGs to `theme_dag()`</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-causal/ggdag" class="external-link">ggdag</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="../reference/theme_dag_blank.html">theme_dag</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="directed-acyclic-graphs">Directed Acyclic Graphs<a class="anchor" aria-label="anchor" href="#directed-acyclic-graphs"></a>
</h2>
<p>A DAG displays assumptions about the relationship between variables
(often called nodes in the context of graphs). The assumptions we make
take the form of lines (or edges) going from one node to another. These
edges are <em>directed</em>, which means to say that they have a single
arrowhead indicating their effect. Here’s a simple DAG where we assume
that <em>x</em> affects <em>y</em>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dagify.html">dagify</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/ggdag.html">ggdag</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro-to-dags_files/figure-html/unnamed-chunk-1-1.png" width="1280" style="display: block; margin: auto;"></p>
<p>You also sometimes see edges that look bi-directed, like this:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dagify.html">dagify</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="op">~</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/ggdag.html">ggdag</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro-to-dags_files/figure-html/unnamed-chunk-2-1.png" width="1280" style="display: block; margin: auto;"></p>
<p>But this is actually shorthand for an unmeasured cause of the two
variables (in other words, unmeasured confounding):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#  canonicalize the DAG: Add the latent variable in to the graph</span></span>
<span><span class="fu"><a href="../reference/dagify.html">dagify</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="op">~</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/canonicalize.html">ggdag_canonical</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro-to-dags_files/figure-html/unnamed-chunk-3-1.png" width="1280" style="display: block; margin: auto;"></p>
<p>A DAG is also <em>acyclic</em>, which means that there are no
feedback loops; a variable can’t be its own descendant. The above are
all DAGs because they are acyclic, but this is not:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dagify.html">dagify</a></span><span class="op">(</span></span>
<span>  <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,</span>
<span>  <span class="va">x</span> <span class="op">~</span> <span class="va">a</span>,</span>
<span>  <span class="va">a</span> <span class="op">~</span> <span class="va">y</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/ggdag.html">ggdag</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro-to-dags_files/figure-html/unnamed-chunk-4-1.png" width="1280" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="structural-causal-graphs">Structural Causal Graphs<a class="anchor" aria-label="anchor" href="#structural-causal-graphs"></a>
</h2>
<p><code>ggdag</code> is more specifically concerned with structural
causal models (SCMs): DAGs that portray causal assumptions about a set
of variables. Beyond being useful conceptions of the problem we’re
working on (which they are), this also allows us to lean on the
well-developed links between graphical causal paths and statistical
associations. Causal DAGs are mathematically grounded, but they are also
consistent and easy to understand. Thus, when we’re assessing the causal
effect between an exposure and an outcome, drawing our assumptions in
the form of a DAG can help us pick the right model without having to
know much about the math behind it. Another way to think about DAGs is
as non-parametric structural equation models (SEM): we are explicitly
laying out paths between variables, but in the case of a DAG, it doesn’t
matter what form the relationship between two variables takes, only its
direction. The rules underpinning DAGs are consistent whether the
relationship is a simple, linear one, or a more complicated
function.</p>
</div>
<div class="section level2">
<h2 id="relationships-between-variables">Relationships between variables<a class="anchor" aria-label="anchor" href="#relationships-between-variables"></a>
</h2>
<p>Let’s say we’re looking at the relationship between smoking and
cardiac arrest. We might assume that smoking causes changes in
cholesterol, which causes cardiac arrest:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">smoking_ca_dag</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dagify.html">dagify</a></span><span class="op">(</span><span class="va">cardiacarrest</span> <span class="op">~</span> <span class="va">cholesterol</span>,</span>
<span>  <span class="va">cholesterol</span> <span class="op">~</span> <span class="va">smoking</span> <span class="op">+</span> <span class="va">weight</span>,</span>
<span>  <span class="va">smoking</span> <span class="op">~</span> <span class="va">unhealthy</span>,</span>
<span>  <span class="va">weight</span> <span class="op">~</span> <span class="va">unhealthy</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"cardiacarrest"</span> <span class="op">=</span> <span class="st">"Cardiac\n Arrest"</span>,</span>
<span>    <span class="st">"smoking"</span> <span class="op">=</span> <span class="st">"Smoking"</span>,</span>
<span>    <span class="st">"cholesterol"</span> <span class="op">=</span> <span class="st">"Cholesterol"</span>,</span>
<span>    <span class="st">"unhealthy"</span> <span class="op">=</span> <span class="st">"Unhealthy\n Lifestyle"</span>,</span>
<span>    <span class="st">"weight"</span> <span class="op">=</span> <span class="st">"Weight"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  latent <span class="op">=</span> <span class="st">"unhealthy"</span>,</span>
<span>  exposure <span class="op">=</span> <span class="st">"smoking"</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"cardiacarrest"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ggdag.html">ggdag</a></span><span class="op">(</span><span class="va">smoking_ca_dag</span>, text <span class="op">=</span> <span class="cn">FALSE</span>, use_labels <span class="op">=</span> <span class="st">"label"</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro-to-dags_files/figure-html/unnamed-chunk-5-1.png" width="2240" style="display: block; margin: auto;"></p>
<p>The path from smoking to cardiac arrest is <em>directed</em>: smoking
causes cholesterol to rise, which then increases risk for cardiac
arrest. Cholesterol is an intermediate variable between smoking and
cardiac arrest. Directed paths are also chains, because each is causal
on the next. Let’s say we also assume that weight causes cholesterol to
rise and thus increases risk of cardiac arrest. Now there’s another
chain in the DAG: from weight to cardiac arrest. However, this chain is
<em>indirect</em>, at least as far as the relationship between smoking
and cardiac arrest goes.</p>
<p>We also assume that a person who smokes is more likely to be someone
who engages in other unhealthy behaviors, such as overeating. On the
DAG, this is portrayed as a latent (unmeasured) node, called unhealthy
lifestyle. Having a predilection towards unhealthy behaviors leads to
both smoking and increased weight. Here, the relationship between
smoking and weight is through a forked path (weight &lt;- unhealthy
lifestyle -&gt; smoking) rather than a chain; because they have a mutual
parent, smoking and weight are associated (in real life, there’s
probably a more direct relationship between the two, but we’ll ignore
that for simplicity).</p>
<p>Forks and chains are two of the three main types of paths:</p>
<ol style="list-style-type: decimal">
<li>Chains</li>
<li>Forks</li>
<li>Inverted forks (paths with colliders)</li>
</ol>
<p>An inverted fork is when two arrowheads meet at a node, which we’ll
discuss shortly.</p>
<p>There are also common ways of describing the relationships between
nodes: parents, children, ancestors, descendants, and neighbors (there
are a few others, as well, but they refer to less common relationships).
Parents and children refer to direct relationships; descendants and
ancestors can be anywhere along the path to or from a node,
respectively. Here, smoking and weight are both parents of cholesterol,
while smoking and weight are both children of an unhealthy lifestyle.
Cardiac arrest is a descendant of an unhealthy lifestyle, which is in
turn an ancestor of all nodes in the graph.</p>
<p>So, in studying the causal effect of smoking on cardiac arrest, where
does this DAG leave us? We only want to know the directed path from
smoking to cardiac arrest, but there also exists an indirect, or
back-door, path. This is confounding. Judea Pearl, who developed much of
the theory of causal graphs, said that confounding is like water in a
pipe: it flows freely in open pathways, and we need to block it
somewhere along the way. We don’t necessarily need to block the water at
multiple points along the same back-door path, although we may have to
block more than one path. We often talk about <em>confounders</em>, but
really we should talk about <em>confounding</em>, because it is about
the pathway more than any particular node along the path.</p>
<p>Chains and forks are open pathways, so in a DAG where nothing is
conditioned upon, any back-door paths must be one of the two. In
addition to the directed pathway to cardiac arrest, there’s also an open
back-door path through the forked path at unhealthy lifestyle and on
from there through the chain to cardiac arrest:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/paths.html">ggdag_paths</a></span><span class="op">(</span><span class="va">smoking_ca_dag</span>, text <span class="op">=</span> <span class="cn">FALSE</span>, use_labels <span class="op">=</span> <span class="st">"label"</span>, shadow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro-to-dags_files/figure-html/unnamed-chunk-6-1.png" width="2240" style="display: block; margin: auto;"></p>
<p>We need to account for this back-door path in our analysis. There are
many ways to go about that–stratification, including the variable in a
regression model, matching, inverse probability weighting–all with pros
and cons. But each strategy must include a decision about <em>which</em>
variables to account for. Many analysts take the strategy of putting in
all possible confounders. This can be bad news, because adjusting for
colliders and mediators can introduce bias, as we’ll discuss shortly.
Instead, we’ll look at <em>minimally sufficient</em> adjustment sets:
sets of covariates that, when adjusted for, block all back-door paths,
but include no more or no less than necessary. That means there can be
many minimally sufficient sets, and if you remove even one variable from
a given set, a back-door path will open. Some DAGs, like the first one
in this vignette (x -&gt; y), have no back-door paths to close, so the
minimally sufficient adjustment set is empty (sometimes written as
“{}”). Others, like the cyclic DAG above, or DAGs with important
variables that are unmeasured, can not produce any sets sufficient to
close back-door paths.</p>
<p>For the smoking-cardiac arrest question, there is a single set with a
single variable: {weight}. Accounting for weight will give us an
unbiased estimate of the relationship between smoking and cardiac
arrest, assuming our DAG is correct. We do not need to (or want to)
control for cholesterol, however, because it’s an intermediate variable
between smoking and cardiac arrest; controlling for it blocks the path
between the two, which will then bias our estimate (see below for more
on mediation).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/adjustment_sets.html">ggdag_adjustment_set</a></span><span class="op">(</span><span class="va">smoking_ca_dag</span>, text <span class="op">=</span> <span class="cn">FALSE</span>, use_labels <span class="op">=</span> <span class="st">"label"</span>, shadow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro-to-dags_files/figure-html/unnamed-chunk-7-1.png" width="2240" style="display: block; margin: auto;"></p>
<p>More complicated DAGs will produce more complicated adjustment sets;
assuming your DAG is correct, any given set will theoretically close the
back-door path between the outcome and exposure. Still, one set may be
better to use than the other, depending on your data. For instance, one
set may contain a variable known to have a lot of measurement error or
with a lot of missing observations. It may, then, be better to use a set
that you think is going to be a better representation of the variables
you need to include. Including a variable that doesn’t actually
represent the node well will lead to residual confounding.</p>
<p>What about controlling for multiple variables along the back-door
path, or a variable that isn’t along <em>any</em> back-door path? Even
if those variables are not colliders or mediators, it can still cause a
problem, depending on your model. Some estimates, like risk ratios, work
fine when non-confounders are included. This is because they are
<em>collapsible</em>: risk ratios are constant across the strata of
non-confounders. Some common estimates, though, like the odds ratio and
hazard ratio, are <em>non-collapsible</em>: they are not necessarily
constant across strata of non-confounders and thus can be biased by
their inclusion. There are situations, like when the outcome is rare in
the population (the so-called <a href="https://www.wikiwand.com/en/Rare_disease_assumption" class="external-link">rare disease
assumption</a>), or when using sophisticated sampling techniques, like
incidence-density sampling, when they approximate the risk ratio.
Otherwise, including extra variables may be problematic.</p>
</div>
<div class="section level2">
<h2 id="colliders-and-collider-stratification-bias">Colliders and collider-stratification bias<a class="anchor" aria-label="anchor" href="#colliders-and-collider-stratification-bias"></a>
</h2>
<p>In a path that is an inverted fork (x -&gt; m &lt;- y), the node
where two or more arrowheads meet is called a collider (because the
paths collide there). An inverted fork is not an open path; it is
blocked at the collider. That is to say, we don’t need to account for
<em>m</em> to assess for the causal effect of <em>x</em> on <em>y</em>;
the back-door path is already blocked by <em>m</em>.</p>
<p>Let’s consider an example. Influenza and chicken pox are independent;
their causes (influenza viruses and the varicella-zoster virus,
respectively) have nothing to do with each other. In real life, there
may be some confounders that associate them, like having a depressed
immune system, but for this example we’ll assume that they are
unconfounded. However, both the flu and chicken pox cause fevers. The
DAG looks like this:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fever_dag</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/quick_plot.html">collider_triangle</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="st">"Influenza"</span>,</span>
<span>  y <span class="op">=</span> <span class="st">"Chicken Pox"</span>,</span>
<span>  m <span class="op">=</span> <span class="st">"Fever"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ggdag.html">ggdag</a></span><span class="op">(</span><span class="va">fever_dag</span>, text <span class="op">=</span> <span class="cn">FALSE</span>, use_labels <span class="op">=</span> <span class="st">"label"</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro-to-dags_files/figure-html/unnamed-chunk-8-1.png" width="1280" style="display: block; margin: auto;"></p>
<p>If we want to assess the causal effect of influenza on chicken pox,
we do not need to account for anything. In the terminology used by
Pearl, they are already <em>d-separated</em> (direction separated),
because there is no effect on one by the other, nor are there any
back-door paths:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/d_relationship.html">ggdag_dseparated</a></span><span class="op">(</span><span class="va">fever_dag</span>, text <span class="op">=</span> <span class="cn">FALSE</span>, use_labels <span class="op">=</span> <span class="st">"label"</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro-to-dags_files/figure-html/unnamed-chunk-9-1.png" width="2240" style="display: block; margin: auto;"></p>
<p>However, if we control for fever, they become associated within
strata of the collider, fever. We open a biasing pathway between the
two, and they become d-connected:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/d_relationship.html">ggdag_dseparated</a></span><span class="op">(</span><span class="va">fever_dag</span>,</span>
<span>  controlling_for <span class="op">=</span> <span class="st">"m"</span>,</span>
<span>  text <span class="op">=</span> <span class="cn">FALSE</span>, use_labels <span class="op">=</span> <span class="st">"label"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="intro-to-dags_files/figure-html/unnamed-chunk-10-1.png" width="2240" style="display: block; margin: auto;"></p>
<p>This can be counter-intuitive at first. Why does controlling for a
confounder reduce bias but adjusting for a collider increase it? It’s
because whether or not you have a fever tells me something about your
disease. If you have a fever, but you don’t have the flu, I now have
more evidence that you have chicken pox. Pearl presents it like algebra:
I can’t solve <em>y</em> = 10 + <em>m</em>. But when I know that
<em>m</em> = 1, I can solve for <em>y</em>.</p>
<p>Unfortunately, there’s a second, less obvious form of
collider-stratification bias: adjusting on the <em>descendant</em> of a
collider. That means that a variable downstream from the collider can
also cause this form of bias. For example, with our flu-chicken
pox-fever example, it may be that having a fever leads to people taking
a fever reducer, like acetaminophen. Because fever reducers are
downstream from fever, controlling for it induces downstream
collider-stratification bias:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dagify.html">dagify</a></span><span class="op">(</span><span class="va">fever</span> <span class="op">~</span> <span class="va">flu</span> <span class="op">+</span> <span class="va">pox</span>,</span>
<span>  <span class="va">acetaminophen</span> <span class="op">~</span> <span class="va">fever</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"flu"</span> <span class="op">=</span> <span class="st">"Influenza"</span>,</span>
<span>    <span class="st">"pox"</span> <span class="op">=</span> <span class="st">"Chicken Pox"</span>,</span>
<span>    <span class="st">"fever"</span> <span class="op">=</span> <span class="st">"Fever"</span>,</span>
<span>    <span class="st">"acetaminophen"</span> <span class="op">=</span> <span class="st">"Acetaminophen"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/d_relationship.html">ggdag_dseparated</a></span><span class="op">(</span></span>
<span>    from <span class="op">=</span> <span class="st">"flu"</span>, to <span class="op">=</span> <span class="st">"pox"</span>, controlling_for <span class="op">=</span> <span class="st">"acetaminophen"</span>,</span>
<span>    text <span class="op">=</span> <span class="cn">FALSE</span>, use_labels <span class="op">=</span> <span class="st">"label"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="intro-to-dags_files/figure-html/unnamed-chunk-11-1.png" width="2240" style="display: block; margin: auto;"></p>
<p>Collider-stratification bias is responsible for many cases of bias,
and it is often not dealt with appropriately. Selection bias, missing
data, and publication bias can all be thought of as
collider-stratification bias. It becomes trickier in more complicated
DAGs; sometimes colliders are also confounders, and we need to either
come up with a strategy to adjust for the resulting bias from adjusting
the collider, or we need to pick the strategy that’s likely to result in
the least amount of bias. See the vignette on <a href="bias-structures.html">common structures of bias</a> for more.</p>
</div>
<div class="section level2">
<h2 id="mediation">Mediation<a class="anchor" aria-label="anchor" href="#mediation"></a>
</h2>
<p>Controlling for intermediate variables may also induce bias, because
it decomposes the total effect of <em>x</em> on <em>y</em> into its
parts. Depending on the research question, that may be exactly what you
want, in which case you should use mediation analysis, e.g. via SEM,
which can estimate direct, indirect, and total effects. Let’s return to
the smoking example. Here, we only care about how smoking affects
cardiac arrest, not the pathways through cholesterol it may take.
Moreover, since cholesterol (at least in our DAG) intercepts the only
directed pathway from smoking to cardiac arrest, controlling for it will
block that relationship; smoking and cardiac arrest will appear
unassociated (note that I’m not including the paths opened by
controlling for a collider in this plot for clarity):</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/d_relationship.html">ggdag_dseparated</a></span><span class="op">(</span><span class="va">smoking_ca_dag</span>,</span>
<span>  controlling_for <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"weight"</span>, <span class="st">"cholesterol"</span><span class="op">)</span>,</span>
<span>  text <span class="op">=</span> <span class="cn">FALSE</span>, use_labels <span class="op">=</span> <span class="st">"label"</span>, collider_lines <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="intro-to-dags_files/figure-html/unnamed-chunk-12-1.png" width="2240" style="display: block; margin: auto;"></p>
<p>Now smoking and cardiac arrest are d-separated. Since our question is
about the total effect of smoking on cardiac arrest, our result is now
going to be biased.</p>
</div>
<div class="section level2">
<h2 id="resources">Resources<a class="anchor" aria-label="anchor" href="#resources"></a>
</h2>
<ul>
<li>Judea Pearl also has a number of texts on the subject of varying
technical difficulty. A friendly start is his recently released <a href="https://books.google.com/books?id=9H0dDQAAQBAJ&amp;printsec=frontcover&amp;dq=book+of+why&amp;hl=en&amp;sa=X&amp;ved=0ahUKEwiwts6Lz5fcAhUBCTQIHdNpAlkQ6AEIKTAA#v=onepage&amp;q=book%20of%20why&amp;f=false" class="external-link">Book
of Why</a>, as well as his article summarizing the book: <a href="http://ftp.cs.ucla.edu/pub/stat_ser/r481.pdf" class="external-link">The Seven Tools of
Causal Inference with Reflections on Machine Learning</a>. A more
technical introduction is <a href="http://bayes.cs.ucla.edu/PRIMER/" class="external-link">Causal Inference in Statistics:
A Primer</a>. See also his article with Sander Greenland and James
Robins on collapsibility: Confounding and Collapsibility in Causal
Inference.</li>
<li>Miguel Hernán, who has written extensively on the subject of causal
inference and DAGs, has an accessible course on edx that teaches the use
of DAGs for causal inference: <a href="https://www.edx.org/learn/data-analysis/harvard-university-causal-diagrams-draw-your-assumptions-before-your-conclusions" class="external-link">Causal
Diagrams: Draw Your Assumptions Before Your Conclusions</a>. Also see
his article The Hazard of Hazard Ratios</li>
<li>Julia Rohrer has a very readable paper introducing DAGs, mostly from
the perspective of psychology: Thinking Clearly About Correlations and
Causation: Graphical Causal Models for Observational Data</li>
<li>If you’re an epidemiologist, I also recommend the chapter on DAGs in
<a href="https://books.google.com/books/about/Modern_Epidemiology.html?id=Z3vjT9ALxHUC" class="external-link">Modern
Epidemiology</a>.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://malco.io" class="external-link">Malcolm Barrett</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>

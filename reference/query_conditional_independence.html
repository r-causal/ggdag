<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Query and Test Conditional Independence in a DAG — query_conditional_independence • ggdag</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Query and Test Conditional Independence in a DAG — query_conditional_independence"><meta name="description" content="query_conditional_independence() queries conditional independencies implied
by a given DAG. These serve as potential robustness checks for your DAG.
test_conditional_independence() runs the tests of independence implied by
the DAG on a given dataset. ggdag_conditional_independence() plots the
results as a forest plot."><meta property="og:description" content="query_conditional_independence() queries conditional independencies implied
by a given DAG. These serve as potential robustness checks for your DAG.
test_conditional_independence() runs the tests of independence implied by
the DAG on a given dataset. ggdag_conditional_independence() plots the
results as a forest plot."><meta property="og:image" content="https://r-causal.github.io/ggdag/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggdag</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.13.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/intro-to-ggdag.html">An Introduction to ggdag</a></li>
    <li><a class="dropdown-item" href="../articles/intro-to-dags.html">An Introduction to DAGs</a></li>
    <li><a class="dropdown-item" href="../articles/bias-structures.html">Common Structures of Bias</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-causal/ggdag/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Query and Test Conditional Independence in a DAG</h1>
      <small class="dont-index">Source: <a href="https://github.com/r-causal/ggdag/blob/main/R/implied_conditional_independence.R" class="external-link"><code>R/implied_conditional_independence.R</code></a></small>
      <div class="d-none name"><code>query_conditional_independence.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>query_conditional_independence()</code> queries conditional independencies implied
by a given DAG. These serve as potential robustness checks for your DAG.
<code>test_conditional_independence()</code> runs the tests of independence implied by
the DAG on a given dataset. <code>ggdag_conditional_independence()</code> plots the
results as a forest plot.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">query_conditional_independence</span><span class="op">(</span></span>
<span>  <span class="va">.tdy_dag</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"missing.edge"</span>,</span>
<span>  max.results <span class="op">=</span> <span class="cn">Inf</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">test_conditional_independence</span><span class="op">(</span></span>
<span>  <span class="va">.tdy_dag</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cis"</span>, <span class="st">"cis.loess"</span>, <span class="st">"cis.chisq"</span>, <span class="st">"cis.pillai"</span>, <span class="st">"tetrads"</span>, <span class="st">"tetrads.within"</span>,</span>
<span>    <span class="st">"tetrads.between"</span>, <span class="st">"tetrads.epistemic"</span><span class="op">)</span>,</span>
<span>  tests <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sample.cov <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sample.nobs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  conf.level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  R <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max.conditioning.variables <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  abbreviate.names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  tol <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  loess.pars <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggdag_conditional_independence</span><span class="op">(</span></span>
<span>  <span class="va">.test_result</span>,</span>
<span>  sort <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  vline_linewidth <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  vline_color <span class="op">=</span> <span class="st">"grey70"</span>,</span>
<span>  pointrange_fatten <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--tdy-dag">.tdy_dag<a class="anchor" aria-label="anchor" href="#arg--tdy-dag"></a></dt>
<dd><p>A <code>tidy_dagitty</code> or <code>dagitty</code> object</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>can be one of "missing.edge", "basis.set", or "all.pairs". With the first, one or
more minimal testable implication (with the smallest possible conditioning set)
is returned per missing edge of the graph. With "basis.set", one testable
implication is returned per vertex of the graph that has non-descendants other than
its parents. Basis sets can be smaller, but they involve higher-dimensional independencies,
whereas missing edge sets involve only independencies between two variables at a time.
With "all.pairs", the function will return a list of all implied conditional independencies
between two variables at a time. Beware, because this can be a very long list and it
may not be feasible to compute this except for small graphs.</p></dd>


<dt id="arg-max-results">max.results<a class="anchor" aria-label="anchor" href="#arg-max-results"></a></dt>
<dd><p>integer. The listing of conditional independencies is stopped once
this many results have been found. Use <code>Inf</code> to generate them all. This applies
only when <code>type="missing.edge"</code> or <code>type="all"</code>.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>matrix or data frame containing the data.</p></dd>


<dt id="arg-tests">tests<a class="anchor" aria-label="anchor" href="#arg-tests"></a></dt>
<dd><p>list of the precise tests to perform. If not given, the list
of tests is automatically derived from the input graph. Can be used to restrict
testing to only a certain subset of tests (for instance, to test only those conditional
independencies for which the conditioning set is of a reasonably low dimension, such
as shown in the example).</p></dd>


<dt id="arg-sample-cov">sample.cov<a class="anchor" aria-label="anchor" href="#arg-sample-cov"></a></dt>
<dd><p>the sample covariance matrix; ignored if <code>data</code> is supplied.
Either <code>data</code> or <code>sample.cov</code> and <code>sample.nobs</code> must be supplied.</p></dd>


<dt id="arg-sample-nobs">sample.nobs<a class="anchor" aria-label="anchor" href="#arg-sample-nobs"></a></dt>
<dd><p>number of observations; ignored if <code>data</code> is supplied.</p></dd>


<dt id="arg-conf-level">conf.level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>determines the size of confidence intervals for test
statistics.</p></dd>


<dt id="arg-r">R<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>how many bootstrap replicates for estimating confidence
intervals. If <code>NULL</code>, then confidence intervals are based on normal
approximation. For tetrads, the normal approximation is only valid in
large samples even if the data are normally distributed.</p></dd>


<dt id="arg-max-conditioning-variables">max.conditioning.variables<a class="anchor" aria-label="anchor" href="#arg-max-conditioning-variables"></a></dt>
<dd><p>for conditional independence testing, this
 parameter can be used to perform only those tests where the number of conditioning
variables does not exceed the given value. High-dimensional
conditional independence tests can be very unreliable.</p></dd>


<dt id="arg-abbreviate-names">abbreviate.names<a class="anchor" aria-label="anchor" href="#arg-abbreviate-names"></a></dt>
<dd><p>logical. Whether to abbreviate variable names (these are used as
row names in the returned data frame).</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>bound value for tolerated deviation from local test value. By default, we perform
a two-sided test of the hypothesis theta=0. If this parameter is given, the test changes
to abs(theta)=tol versus abs(theta)&gt;tol.</p></dd>


<dt id="arg-loess-pars">loess.pars<a class="anchor" aria-label="anchor" href="#arg-loess-pars"></a></dt>
<dd><p>list of parameter to be passed on to  <code><a href="https://rdrr.io/r/stats/loess.html" class="external-link">loess</a></code>
  (for <code>type="cis.loess"</code>), for example the smoothing range.</p>
<p><code>ciTest(X,Y,Z,data)</code> is a convenience function to test a single conditional independence
independently of a DAG.</p></dd>


<dt id="arg--test-result">.test_result<a class="anchor" aria-label="anchor" href="#arg--test-result"></a></dt>
<dd><p>A data frame containing the results of conditional
independence tests created by <code>test_conditional_independence()</code>.</p></dd>


<dt id="arg-sort">sort<a class="anchor" aria-label="anchor" href="#arg-sort"></a></dt>
<dd><p>Logical indicating whether to sort the results by estimate value.
Default is <code>TRUE</code>.</p></dd>


<dt id="arg-vline-linewidth">vline_linewidth<a class="anchor" aria-label="anchor" href="#arg-vline-linewidth"></a></dt>
<dd><p>Line width for the vertical line indicating no effect.</p></dd>


<dt id="arg-vline-color">vline_color<a class="anchor" aria-label="anchor" href="#arg-vline-color"></a></dt>
<dd><p>Color of the vertical line.</p></dd>


<dt id="arg-pointrange-fatten">pointrange_fatten<a class="anchor" aria-label="anchor" href="#arg-pointrange-fatten"></a></dt>
<dd><p>Factor to fatten the point range.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Either a tibble summarizing the conditional independencies in the DAG
or test results, or a ggplot of the results.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://malco.io" class="external-link">Malcolm Barrett</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

